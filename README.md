# 观我生 - 诗歌在场 (含后台管理)

这是一个结合了心理测试与诗歌生成的互动网页应用。用户通过回答一系列问题，最终会得到一首与他们心境相匹配的现代诗。本项目在原有功能基础上，增加了一个简单的后台管理系统，用于动态编辑和管理诗歌库。

## 功能特性

- **前端应用 (Quiz App)**:
    - 一个包含4个问题的心理测试。
    - 根据用户的选择组合，匹配并展示一首专属诗歌。
    - 集成Gemini API，提供“解诗”和“读诗”的AI功能。
    - 包含一个调试模式，方便开发者追踪应用状态。

- **后台管理 (Admin Panel)**:
    - **诗歌管理**: 在一个专门的管理页面 (`/admin.html`) 中，可以对诗歌进行增、删、改、查操作。
    - **目录视图**: 左侧边栏会实时展示 `poems` 文件夹下的所有诗歌文件和子目录。
    - **文本编辑**: 提供一个简洁的文本编辑区域，用于修改和撰写诗歌内容。
    - **持久化存储**: 所有诗歌都作为独立的 `.txt` 文件保存在服务器的 `poems/` 目录下，方便管理和备份。

## 技术架构

本项目采用轻量级的 `Node.js` + `Express` 作为后端，为纯静态的前端页面提供数据接口和文件操作能力。

- **后端**: Node.js 运行时, Express 框架。
- **前端**: HTML, Tailwind CSS, 原生 JavaScript。
- **数据存储**: 诗歌以 `.txt` 格式的文件存储在服务器本地的 `/poems` 文件夹中。诗歌标题即为文件名（不含扩展名）。

## 项目结构

```
.
├── poems/                  # 存放所有诗歌.txt文件
│   ├── 《论保持希望》.txt
│   └── ... (其他诗歌)
├── public/                 # 存放所有前端静态资源
│   ├── index.html          # 主应用(心理测试)页面
│   ├── admin.html          # 后台管理页面
│   └── admin.js            # 后台管理页面的逻辑脚本
├── package.json            # 项目依赖与脚本配置
└── server.js               # Node.js Express服务器主文件
```

## 安装与启动

**环境要求**:
- [Node.js](https://nodejs.org/) (建议LTS版本)
- npm (通常随Node.js一同安装)

**步骤**:
1.  **克隆或下载项目到本地。**

2.  **安装依赖**:
    打开终端，进入项目根目录，运行以下命令：
    ```bash
    npm install
    ```

3.  **启动服务器**:
    ```bash
    node server.js
    ```
    启动成功后，你会在终端看到类似 `Server running at http://localhost:3000` 的提示。

4.  **访问应用**:
    - **心理测试主页**: 在浏览器中打开 `http://localhost:3000`
    - **后台管理页面**: 在浏览器中打开 `http://localhost:3000/admin.html`

## API 端点说明 (供参考)

后台服务器提供了以下API端点来支持前后端交互：

- `GET /api/poems-all`:
  - **功能**: 获取所有诗歌，并以主应用所需的 `{'标题': '内容', ...}` JSON格式返回。
  - **用途**: `index.html` 页面加载时调用，以获取测试所需的所有诗歌数据。

- `GET /api/poems-tree`:
  - **功能**: 获取 `poems` 目录的层级结构（包含文件和文件夹）。
  - **用途**: `admin.html` 页面加载时调用，用于渲染左侧的诗歌目录树。

- `GET /api/poem?path=<path>`:
  - **功能**: 根据提供的文件相对路径，获取单个诗歌文件的纯文本内容。
  - **用途**: 在后台管理页面，点击某个诗歌文件时调用，将内容加载到编辑器中。

- `POST /api/poem`:
  - **功能**: 创建一个新的诗歌文件。
  - **请求体**: `{ "path": "相对路径/文件名.txt", "content": "诗歌内容" }`
  - **用途**: 在后台管理页面，保存新创建的诗歌。

- `PUT /api/poem`:
  - **功能**: 更新一个已存在的诗歌文件。
  - **请求体**: `{ "path": "文件相对路径.txt", "content": "更新后的诗歌内容" }`
  - **用途**: 在后台管理页面，保存对现有诗歌的修改。

- `DELETE /api/poem`:
  - **功能**: 删除一个诗歌文件或一个空目录。
  - **请求体**: `{ "path": "文件或目录的相对路径" }`
  - **用途**: 在后台管理页面，删除指定的诗歌或文件夹。 