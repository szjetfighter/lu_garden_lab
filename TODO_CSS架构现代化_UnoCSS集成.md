# TODO：CSS架构现代化 UnoCSS集成

> **🤖 AI 助手注意 (AI Assistant Attention)**
> 在执行本文件中的任何任务前，你必须首先阅读并严格遵守位于 `documentation/ai-collaboration-guide.md` 的全局协作指南。

## 目标
通过引入UnoCSS实现CSS架构现代化，提升开发效率和代码质量，同时保持现有视觉效果的完全一致性。基于深度技术选型分析，UnoCSS在性能、Vue生态匹配度和技术先进性方面优于Tailwind CSS。

## 范围与约束
- **范围**: 本次任务聚焦于Vue前端的CSS架构升级，从传统CSS迁移至UnoCSS utility-first架构。
- **约束**:
  - 所有视觉效果必须100%保持一致，不得有任何视觉回归。
  - 必须保持Tailwind语法兼容性，确保开发体验连续性。
  - 采用渐进式迁移策略，避免大规模重写风险。

## 任务列表

> 任务编号规范
> - 阶段A使用前缀"A"：任务A.1、任务A.2 …；步骤使用"A.1.x"的三级编号
> - 阶段B使用前缀"B"：任务B.1、任务B.2 …；步骤使用"B.1.x"
> - 阶段C使用前缀"C"：任务C.1、任务C.2 …；步骤使用"C.1.x"
> - 阶段D使用前缀"D"：任务D.1、任务D.2 …；步骤使用"D.1.x"
> - 注意，上述阶段X，都是指在当前TODOlist中的阶段，而非其他。

---

### **阶段A：基础设施搭建与设计系统映射**

#### - [ ] 任务A.1：UnoCSS基础设施搭建
- **核心思想**: 建立UnoCSS开发环境基础设施，确保与现有Vue3 + TypeScript + Vite技术栈完全兼容，为后续CSS架构迁移奠定稳固技术基础。
- **交付物**:
  - UnoCSS配置文件和Vite插件集成
  - 包依赖管理更新
  - UnoCSS入口样式文件
  - 基础功能验证
- **验收标准**:
  - 开发环境UnoCSS成功启动，Tailwind兼容预设正常工作
  - 生产环境构建成功，无错误和警告
  - TypeScript类型检查通过
  - 基础utility类（如p-4, text-center）正常生效
- **预期改动文件**:
  - `lugarden_universal/frontend_vue/package.json` - 添加UnoCSS相关依赖
  - `lugarden_universal/frontend_vue/uno.config.ts` - UnoCSS配置文件
  - `lugarden_universal/frontend_vue/vite.config.ts` - Vite插件配置
  - `lugarden_universal/frontend_vue/src/main.ts` - 导入UnoCSS样式
  - `lugarden_universal/frontend_vue/src/assets/styles/uno.css` - UnoCSS入口文件
- **完成状态**: 🔄 待开始
- **执行步骤**:
  - [ ] **步骤A.1.1 (安装依赖)**: 安装UnoCSS相关依赖包 (unocss, @unocss/preset-wind, @unocss/preset-uno)
  - [ ] **步骤A.1.2 (配置文件)**: 创建uno.config.ts，启用Tailwind兼容预设
  - [ ] **步骤A.1.3 (Vite集成)**: 配置Vite UnoCSS插件，确保与现有样式不冲突
  - [ ] **步骤A.1.4 (样式入口)**: 创建UnoCSS入口文件并在main.ts中引入

#### - [ ] 任务A.2：设计系统映射与CSS变量集成
- **核心思想**: 建立现有CSS变量系统与UnoCSS设计令牌的双向映射关系，确保设计系统的一致性和可维护性，为组件级迁移做好准备。
- **交付物**:
  - CSS变量与UnoCSS令牌映射配置
  - 自定义主题扩展
  - 设计系统令牌验证
- **验收标准**:
  - 现有CSS变量在UnoCSS配置中正确映射
  - 自定义主题令牌在开发和生产环境正常工作
  - 颜色、字体、间距等设计令牌100%对应
  - 响应式断点配置与现有系统一致
- **预期改动文件**:
  - `lugarden_universal/frontend_vue/uno.config.ts` - 扩展主题配置
  - `lugarden_universal/frontend_vue/src/assets/styles/uno.css` - 自定义CSS变量映射
- **完成状态**: 🔄 待开始
- **执行步骤**:
  - [ ] **步骤A.2.1 (变量分析)**: 分析现有CSS变量系统结构
  - [ ] **步骤A.2.2 (主题扩展)**: 在UnoCSS配置中创建对应的theme扩展
  - [ ] **步骤A.2.3 (映射建立)**: 建立CSS变量与UnoCSS令牌的双向映射关系
  - [ ] **步骤A.2.4 (功能验证)**: 验证自定义主题正确工作

---

### **阶段B：样式兼容层与组件分析**

#### - [ ] 任务B.1：样式兼容层创建
- **核心思想**: 建立UnoCSS与现有CSS系统的兼容层，确保渐进式迁移过程中样式不冲突，为安全的组件级重构创造条件。
- **交付物**:
  - CSS命名空间和优先级管理
  - UnoCSS与现有类名的兼容映射
  - 渐进式覆盖策略实现
- **验收标准**:
  - UnoCSS类名与现有CSS类名无优先级冲突
  - Tailwind语法在项目中100%兼容
  - CSS层级确保正确的样式覆盖顺序
  - 现有组件样式完全不受影响
- **预期改动文件**:
  - `lugarden_universal/frontend_vue/uno.config.ts` - 配置CSS层级
  - `lugarden_universal/frontend_vue/src/assets/styles/uno.css` - 兼容层样式
- **完成状态**: 🔄 待开始
- **执行步骤**:
  - [ ] **步骤B.1.1 (命名空间)**: 创建CSS namespace防止优先级冲突
  - [ ] **步骤B.1.2 (兼容映射)**: 建立UnoCSS与现有类名的兼容映射
  - [ ] **步骤B.1.3 (层级配置)**: 配置CSS层级确保渐进式覆盖策略
  - [ ] **步骤B.1.4 (语法验证)**: 验证Tailwind语法100%兼容

#### - [ ] 任务B.2：组件CSS audit与分类
- **核心思想**: 系统性审计所有Vue组件的CSS代码，按照保留/重构策略进行分类，为精准的组件级迁移制定详细计划。
- **交付物**:
  - 组件CSS代码审计报告
  - 保留/重构策略分类标记
  - 迁移优先级排序
- **验收标准**:
  - 所有.vue文件的CSS代码已完成审计和分类
  - 复杂动画、伪元素、兼容性代码准确标记为保留
  - 基础样式代码准确标记为可重构
  - 迁移计划具有可操作性和可追踪性
- **预期改动文件**:
  - 审计报告文档（不修改代码，仅分析）
- **完成状态**: 🔄 待开始
- **执行步骤**:
  - [ ] **步骤B.2.1 (CSS扫描)**: 扫描所有.vue文件中的CSS代码，建立样式清单
  - [ ] **步骤B.2.2 (策略分类)**: 按照保留/重构策略对CSS代码进行分类标记
  - [ ] **步骤B.2.3 (复杂标识)**: 识别复杂动画、伪元素、兼容性代码等需保留的部分
  - [ ] **步骤B.2.4 (重构标记)**: 标记可直接用UnoCSS(Tailwind语法)替换的基础样式代码

---

### **阶段C：组件迁移与性能验证**

#### - [ ] 任务C.1：Pilot组件迁移验证
- **核心思想**: 选择样式相对简单的组件作为迁移试点，验证混合处理原则的可行性，为批量组件重构积累经验和最佳实践。
- **交付物**:
  - Pilot组件迁移完成
  - 迁移模式和最佳实践总结
  - 性能对比报告
- **验收标准**:
  - Pilot组件视觉效果100%一致
  - UnoCSS性能优势得到验证
  - 混合处理原则运行良好
  - 开发体验显著改善
- **预期改动文件**:
  - 选定的Pilot组件.vue文件 - 样式重构
- **完成状态**: 🔄 待开始
- **执行步骤**:
  - [ ] **步骤C.1.1 (组件选择)**: 选择样式相对简单的组件作为试点
  - [ ] **步骤C.1.2 (混合迁移)**: 应用混合处理原则：基础样式迁移至UnoCSS，特殊逻辑保留
  - [ ] **步骤C.1.3 (视觉测试)**: 进行详细的视觉回归测试，确保迁移效果一致
  - [ ] **步骤C.1.4 (性能验证)**: 验证UnoCSS性能优势：构建速度提升和开发体验改善

#### - [ ] 任务C.2：批量组件重构
- **核心思想**: 基于Pilot组件验证的经验，将成功的迁移模式应用到其余组件，实现大规模的CSS架构现代化，同时严格控制质量。
- **交付物**:
  - 所有目标组件迁移完成
  - 统一的样式架构
  - 代码review检查点
- **验收标准**:
  - 所有组件视觉效果保持100%一致
  - utility样式迁移覆盖率达到90%以上
  - 复杂业务逻辑相关样式保持不变
  - 通过所有代码review检查点
- **预期改动文件**:
  - 多个Vue组件.vue文件 - 样式重构
- **完成状态**: 🔄 待开始
- **执行步骤**:
  - [ ] **步骤C.2.1 (模式应用)**: 应用经验证的迁移模式到其余组件
  - [ ] **步骤C.2.2 (utility重构)**: 优先处理重复度高的utility样式，使用Tailwind兼容语法
  - [ ] **步骤C.2.3 (业务保留)**: 保持复杂业务逻辑相关样式不变
  - [ ] **步骤C.2.4 (质量控制)**: 建立代码review检查点确保质量

#### - [ ] 任务C.3：性能优化验证
- **核心思想**: 验证UnoCSS按需生成机制的性能优势，确保CSS架构现代化带来预期的性能提升和开发效率改善。
- **交付物**:
  - 性能对比报告
  - 包体积分析
  - 开发体验改善评估
- **验收标准**:
  - CSS包体积减少30-50%
  - 构建时间提升20-30%
  - HMR速度显著提升
  - 所有浏览器兼容性测试通过
- **预期改动文件**:
  - 性能分析报告（不修改代码）
- **完成状态**: 🔄 待开始
- **执行步骤**:
  - [ ] **步骤C.3.1 (按需验证)**: 验证UnoCSS零预设按需生成机制，确认无冗余样式
  - [ ] **步骤C.3.2 (性能对比)**: 对比迁移前后的CSS包体积和构建时间
  - [ ] **步骤C.3.3 (开发体验)**: 测试开发环境HMR速度提升效果
  - [ ] **步骤C.3.4 (兼容性测试)**: 确认所有组件在不同设备和浏览器中的表现一致

---

### **阶段D：交互体验现代化（低优先级）**

#### - [ ] 任务D.1：诗歌展示页交互体验现代化重构
- **核心思想**: 利用UnoCSS的utility-first优势，重新设计诗歌展示页的交互体验，引入现代化的微交互和动画效果，提升用户参与度。
- **交付物**:
  - 现代化交互设计方案
  - 微交互动画实现
  - 用户体验提升评估
- **验收标准**:
  - 交互响应更加流畅自然
  - 微动画符合现代设计语言
  - 用户参与度和满意度提升
  - 性能影响控制在可接受范围
- **预期改动文件**:
  - `lugarden_universal/frontend_vue/src/views/ResultScreen.vue` - 交互重设计
  - `lugarden_universal/frontend_vue/src/components/PoemViewer.vue` - 微交互增强
  - 相关动画样式文件
- **完成状态**: 🔄 待开始（低优先级）
- **执行步骤**:
  - [ ] **步骤D.1.1 (交互分析)**: 分析当前诗歌展示页的交互痛点
  - [ ] **步骤D.1.2 (设计方案)**: 设计现代化的交互体验方案
  - [ ] **步骤D.1.3 (微交互实现)**: 使用UnoCSS实现微交互和动画效果
  - [ ] **步骤D.1.4 (体验评估)**: 进行用户体验评估和性能影响分析

---

## 测试与验收
- **阶段A**: 
  - UnoCSS开发环境成功搭建并可正常使用
  - 设计系统映射正确，自定义主题正常工作
- **阶段B**: 
  - 样式兼容层正常工作，无优先级冲突
  - 组件CSS审计完成，迁移策略明确
- **阶段C**: 
  - 所有组件迁移完成，视觉效果100%一致
  - 性能指标达到预期提升目标
- **阶段D**: 
  - 交互体验现代化效果显著
  - 用户满意度和参与度提升

## 更新日志关联
- **预计更新类型**: [架构重构/性能优化]
- **更新目录**: `documentation/changelog/YYYY-MM-DD_CSS_architecture_modernization_UnoCSS/`
- **更新日志文件**: `更新日志.md`
- **测试验证点**:
  - [ ] UnoCSS基础设施搭建成功
  - [ ] 设计系统映射完成
  - [ ] 组件迁移完成，视觉效果一致
  - [ ] 性能指标达到预期

## 完成后的操作
- [ ] 创建更新目录：`documentation/changelog/YYYY-MM-DD_CSS_architecture_modernization_UnoCSS/`
- [ ] 将本TODO文件移动到更新目录并重命名为 `TODO.md`
- [ ] 创建对应的更新日志文档：`更新日志.md`
- [ ] 提交所有更改到Git

---

*本TODO清单基于项目CSS架构现代化需求创建，遵循项目标准TODO模板格式。*
